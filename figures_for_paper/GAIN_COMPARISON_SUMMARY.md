# 逆補償ゲイン比較分析 (Inverse Compensation Gain Comparison)

## データセット

**比較対象:**
- **Gain α=9**: `17_noise_inverse_heatmap` ディレクトリ
  - 200シミュレーション (50 runs × 4 noise levels)
  - Noise: 0, 5, 10, 15 ms
  
- **Gain α=10**: `16_tau_noise` ディレクトリ (tau=100msのみ抽出)
  - 40シミュレーション (10 runs × 4 noise levels)
  - Noise: 0, 5, 10, 15 ms

**共通パラメータ:**
- Plant time constant τ = 100 ms
- PID gains: Kp=15, Ki=5, Kd=8
- Target position: 5.0 m
- Compensation position: post-plant

## 主な結果

### RMSE比較 (Baseline RTからの誤差)

| Noise (ms) | Gain α=9 (mm) | Gain α=10 (mm) | 差分 (mm) | 改善率 |
|------------|---------------|----------------|-----------|--------|
| 0          | 8.527 ± 5.371 | 0.000 ± 0.000  | +8.527    | -     |
| 5          | 9.065 ± 4.910 | 1.568 ± 0.684  | +7.497    | +478% |
| 10         | 10.162 ± 5.090| 3.805 ± 2.244  | +6.358    | +167% |
| 15         | 11.498 ± 5.085| 6.744 ± 4.072  | +4.754    | +71%  |

**平均RMSE:**
- Gain α=9: **9.813 mm**
- Gain α=10: **3.029 mm**
- **Gain α=10の方が約69%良い**

## 重要な発見

### 1. Gain α=10の優位性
- すべてのノイズレベルでGain α=10の方が性能が良い
- 平均で約6.8mm (69%)の改善
- ノイズが無い場合(0ms)でも顕著な差がある

### 2. ノイズ依存性
- ノイズが増えると、両ゲインの差は縮小する
  - 0ms: 8.5mm差
  - 15ms: 4.8mm差
- 高ノイズ環境ではゲインの影響が相対的に減少

### 3. ロバスト性
- Gain α=9: 標準偏差 ~5mm (比較的安定)
- Gain α=10: 標準偏差は小さい (特にnoise=0,5msで)

## 解釈

### なぜGain α=10の方が良いのか？

τ=100msの場合、最適ゲインは理論的に約10に近い値になります:
- **Gain α=9**: やや過小補償 (under-compensation)
  - プラント遅れを完全に補償できていない
  - 残留誤差が大きい

- **Gain α=10**: 適切な補償
  - プラント遅れをほぼ完全に補償
  - Baseline RTに近い性能

### ノイズによる性能差の縮小

ノイズが増えると:
1. プラントの動特性の不確かさが支配的になる
2. 補償ゲインの影響が相対的に減少
3. 両ゲインとも同様に劣化する

## 生成図

1. **`gain_comparison_metrics.png`**
   - RMSE, MAE, Max Deviation の比較
   - エラーバー付きトレンドライン

2. **`gain_comparison_distributions.png`**
   - 各ノイズレベルでのモンテカルロ分布
   - Box plotによる統計的比較

3. **`gain_comparison_difference.png`**
   - 絶対差と相対差の可視化
   - ノイズレベルによる差の変化

## 結論

**推奨:** τ=100msの場合、**Gain α=10を使用すべき**

理由:
- すべてのノイズ条件で優れた性能
- ベースラインRTに対する誤差が最小
- モンテカルロ試行での安定性が高い

**次のステップ:**
- Gain α=8, 9, 10, 11, 12 のスイープを実施中
- 最適ゲインの精密な決定
- ノイズ-ゲインの2Dヒートマップ作成
